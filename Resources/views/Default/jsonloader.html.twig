{#{% include 'VivaitBootstrapBundle:Default:jsonloader.html.twig' with {'htmlid':'','refresh':'','jsonsource':'','template':''} %}#}
<script>
    (function(){
        var refresh_{{ template }} = function () {
                $.ajax('{{ jsonsource }}', {
                    dataType: "json",
                    cache: false,
                    success: function (data) {
                        $("#{{ htmlid }}").html(Twig.render({{ template }}, data));
                        jQuery("abbr[data-livestamp]").livestamp();
                    }
                });
            },
            load = function() {
                setInterval(refresh_{{ template }}, {{ refresh * 1000 }});
                refresh_{{ template }}();
            };

        {% if wait|default(false) %}
        jQuery(window).load(load);
        {% else %}
        load();
        {% endif %}
    })();
</script>
